syms rho f k A n p q x

%%%%%%%%%%%%%%%%%%

% E[An^2(2)|An(1)]
(A*p*(1-p)+(A*(1-p))^2)+((n-A)*q*(1-q)+((n-A)*q)^2)+2*(n-A)*q*A*(1-p)

%%%%%%%%%%%%%%%%%%

% E[An^3(2)|An(1)]
(A*(A-1)*(A-2)*(1-p)^3) + 3*(A*(A-1)*(1-p)^2) + A*(1-p) ...
    + (n-A)*(n-A-1)*(n-A-2)*q^3 + 3*(n-A)*(n-A-1)*q^2 + (n-A)*q ...
    + 3*(A*p*(1-p)+(A*(1-p))^2)*(n-A)*q + 3*((n-A)*q*(1-q)+((n-A)*q)^2)*A*(1-p) 

%%%%%%%%%%%%%%%%%%

r = rho+(1-rho)*f^(k-1);
s = rho-rho*f^(k-1);
%% E[A(k)A(k+1)|A(1)]
f*(A*r*(1-r) + (A*r)^2 + (n-A)*s*(1-s) + ((n-A)*s)^2 + 2*(A*r)*((n-A)*s))+n*q*(A*r+(n-A)*s)

%%%%%%%%%%%%%%%%%%

r = rho+(1-rho)*f^(k-2);
s = rho-rho*f^(k-2);
%% E[A(k)A(k+1)|A(2)]
f*(A*r*(1-r) + (A*r)^2 + (n-A)*s*(1-s) + ((n-A)*s)^2 + 2*(A*r)*((n-A)*s))+n*q*(A*r+(n-A)*s)

%%%%%%%%%%%%%%%%%%

syms rho f k A B n p q x

r = rho+(1-rho)*f^(k-2);
s = rho-rho*f^(k-2);

%% E[A(k)|A(2)]
B*r +(n-B)*s
%% Cov(A(k),A(1)A(2))
A*B*(B*r +(n-B)*s) 
